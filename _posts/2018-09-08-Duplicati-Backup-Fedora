---
layout: post
title: Backing Up Fedora 28 with Duplicati
category: Backup
tags:
- duplicati
- backup
- fedora
subtitle: Simple and Powerful Encrypted Backups
---

Personally, one of the scariest parts of self-hosting is having all my data under one roof. Power issues, theft, fire or other natural disasters are just a few of the potential risks to my data. Luckily, the open source project Duplicati (https://www.duplicati.com/) has proven to be a reliable option. Open Source, AES 256 encryption, and a wide variety of backup destinations supporting anywhere from Webdav, S3, to OneDrive, Mega, Google Drive, Dropbox, and others. This solution has given me offsite backups that are encrypted, while also leveraging the proprietary storage provider space I've accumulated (Samsung 100GB OneDrive storage for two years promos, etc) with no cost and minimal risk of data snooping.

This post is by no means intended to be a detailed Duplicati informative guide, as their website already provides plenty of documentation. I'm documenting my own experience that myself or others can use as a "Getting Started" gritty reference to build the basics of a functioning backup solution in Fedora 28 with emailed logs. Let's begin.

**Duplicati Setup**

Install the prerequisites:

`sudo dnf install mono-core libappindicator libappindicator-sharp desktop-file-utils`

Grab the latest rpm (check their site from a web browser first):

`wget https://updates.duplicati.com/beta/duplicati-2.0.3.3-2.0.3.3_beta_20180402.noarch.rpm`

Install the rpm:

`sudo rpm -ivh duplicati*`

Poke holes in firewalld to allow access to the web management frontend:

`sudo firewall-cmd --permanent --add-port=8200/tcp`
`sudo firewall-cmd --reload`

Start Duplicati and tell it to listen on interfaces other than localhost:

`sudo duplicati-server --webservice-interface=any`

Leave running in terminal, go to the web interface from another pc (http://serverip:8200), set a password, then go back to terminal and ctrl-c.

To work with many third party services, you're going to need to run a cert-sync after setup:

`sudo cert-sync /etc/pki/tls/certs/ca-bundle.crt`

By default, Duplicati expects a graphical desktop and is started by a tray object. I'm running a headless nextcloud instance in this example, so I need to be able to run this as a service instead. Let's grab a service config:

`wget https://raw.githubusercontent.com/duplicati/duplicati/master/Installer/debian/debian/duplicati.service`

Move it:

`sudo mv duplicati.service /etc/systemd/system`

Then enable at startup and start the service:

`sudo systemctl enable duplicati`
`sudo systemctl start duplicati`

Now to move to configuring for our needs via the web interface.

**Configuring a Backup Job**

